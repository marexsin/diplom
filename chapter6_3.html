<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Глава 1</title>
    <link rel="stylesheet" href="assets/css/styl.css">
</head>
<body>

    <header>
        <img src="assets/images/logomini.png" alt="PostgreSQL Logo" class="logo" height="70px">
        <a href="index.html" class="home-link">Вернуться на главную страницу →</a>
    </header>

  <div class="container">
    <nav class="sidebar">
      <h3>Глава 6. Соединение таблиц</h3>
      <ul>
        <li><a href="chapter6.html"> <b> 1. Неявное соединение таблиц</b></a></li>
        <li><a href="chapter6_2.html">2. INNER JOIN</a></li>
        <li><a href="chapter6_3.html">3. OUTER JOIN и CROSS JOIN</a></li>
        <li><a href="chapter6_4.html">4. Группировка в соединениях</a></li>
        <li><a href="chapter6_5.html">5. Объединение множеств. UNION</a></li>
        <li><a href="chapter6_6.html">6. Разность множеств. EXCEPT</a></li>
        <li><a href="chapter6_7.html">7. Пересечение множеств. INTERSECT</a></li>
      </ul>
    </nav>

    <main class="content">
      <h2>OUTER JOIN и CROSS JOIN</h2>
      <p>
        OUTER JOIN или внешнее соединение позволяет возвратить все строки одной или двух таблиц, которые участвуют в соединении.
      </p>

      <p>
        Outer Join имеет следующий формальный синтаксис:
      </p>

      <p>
        Перед оператором <b>JOIN</b> указывается одно из ключевых слов <b>LEFT</b>, <b>RIGHT</b> или <b>FULL</b>, которые определяют тип соединения:
      </p>
      <ul>
        <ol><b>LEFT:</b> выборка будет содержать все строки из первой или левой таблицы</ol>
        <ol><b>RIGHT:</b> выборка будет содержать все строки из второй или правой таблицы</ol>
        <ol><b>FULL:</b> выборка будет содержать все строки из обеих таблиц</ol>
      </ul>

      <p>Перед оператором JOIN может указываться ключевое слово <b>OUTER</b>, но его применение необязательно. После JOIN указывается присоединяемая таблица, а затем идет условие соединения после оператора ON.</p>

      <p>К примеру, возьмем следующие таблицы:</p>



      <p>И соединим таблицы Orders и Customers:</p>



      <p>Таблица Orders является первой или левой таблицей, а таблица Customers - правой таблицей. Поэтому, так как здесь используется выборка по левой таблице, то вначале будут выбираться все строки из Orders, а затем к ним по условию <i>Orders.CustomerId = Customers.Id</i> будут добавляться связанные строки из Customers.</p>

      <img src="assets/images/postgres6.1_3.png" alt="Orders.CustomerId = Customers.Id">

      <p>По вышеприведенному результату может показаться, что левостороннее соединение аналогично INNER Join, но это не так. Inner Join объединяет строки из дух таблиц при соответствии условию. Если одна из таблиц содержит строки, которые не соответствуют этому условию, то данные строки не включаются в выходную выборку. Left Join выбирает все строки первой таблицы и затем присоединяет к ним строки правой таблицы. К примеру, возьмем таблицу Customers и добавим к покупателям информацию об их заказах:</p>



      <img src="assets/images/postgres6.2_3.png" alt="INNER Join, Left Join">

      <p>Изменим в примере выше тип соединения на правостороннее:</p>



      <p>Теперь будут выбираться все строки из Customers, а к ним уже будет присоединяться связанные по условию строки из таблицы Orders:</p>

      <img src="assets/images/postgres6.3_3.png" alt="Правостороннее соединение">

      <p>Поскольку один из покупателей из таблицы Customers не имеет связанных заказов из Orders, то соответствующие столбцы, которые берутся из Orders, будут иметь значение NULL.</p>

      <p>Полное соединение (FULL JOIN) объединяет обе таблицы:</p>


      <p>Используем левостороннее соединение для добавления к заказам информации о пользователях и товарах:</p>



      <img src="assets/images/postgres6.4_3.png" alt="Левостороннее соединение">

      <p>И также можно применять более комплексные условия с фильтрацией и сортировкой. Например, выберем все заказы с информацией о клиентах и товарах по тем товарам, у которых цена больше 55000, и отсортируем по дате заказа:</p>



      <img src="assets/images/postgres6.5_3.png" alt="Комплексные условия">

      <p>Или выберем всех пользователей из Customers, у которых нет заказов в таблице Orders:</p>

  

      <p>Также можно комбинировать Inner Join и Outer Join:</p>

 

      <p>Вначале по условию к таблице Orders через Inner Join присоединяется связанная информация из Products, затем через Outer Join добавляется информация из таблицы Customers.</p>

      <h3>Cross Join</h3>

      <p>Cross Join или перекрестное соединение создает набор строк, где каждая строка из одной таблицы соединяется с каждой строкой из второй таблицы. Например, соединим таблицу заказов Orders и таблицу покупателей Customers:</p>


      <img src="assets/images/postgres6.6_3.png" alt="Cross Join">

      <p>Если в таблице Orders 3 строки, а в таблице Customers то же три строки, то в результате перекрестного соединения создается 3 * 3 = 9 строк вне зависимости, связаны ли данные строки или нет.</p>

      <p>При неявном перекрестном соединении можно опустить оператор CROSS JOIN и просто перечислить все получаемые таблицы:</p>
 
       
    </main>
  </div>

  <div class="transition">
    <button class="next" onclick="location.href='chapter6_2.html'">← Вернуться</button>
    <button class="next" onclick="location.href='chapter6_4.html'">Дальше →</button>
  </div>

  <footer>
    © 2025 PostgreSQL Учебный Портал. Спасибо, что учитесь с нами!
  </footer>

</body>
</html>