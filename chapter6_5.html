<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Глава 1</title>
    <link rel="stylesheet" href="assets/css/styl.css">
</head>
<body>

    <header>
        <img src="assets/images/logomini.png" alt="PostgreSQL Logo" class="logo" height="70px">
        <a href="index.html" class="home-link">Вернуться на главную страницу →</a>
    </header>

  <div class="container">
    <nav class="sidebar">
      <h3>Глава 6. Соединение таблиц</h3>
      <ul>
        <li><a href="chapter6.html">  1. Неявное соединение таблиц</a></li>
        <li><a href="chapter6_2.html">2. INNER JOIN</a></li>
        <li><a href="chapter6_3.html">3. OUTER JOIN и CROSS JOIN</a></li>
        <li><a href="chapter6_4.html">4. Группировка в соединениях</a></li>
        <li><a href="chapter6_5.html"><b>5. Объединение множеств. UNION</b></a></li>
        <li><a href="chapter6_6.html">6. Разность множеств. EXCEPT</a></li>
        <li><a href="chapter6_7.html">7. Пересечение множеств. INTERSECT</a></li>
      </ul>
    </nav>

    <main class="content">
      <h2>Объединение множеств. UNION</h2>
      <p>
        Оператор UNION позволяет объединить два множества (условно две таблицы). Но в отличие от inner/outer join объединения соединяют не столбцы разных таблиц, а два однотипных набора в один. Формальный синтаксис объединения:
      </p>


      <p>
        Например, пусть в базе данных будут две отдельные таблицы для клиентов банка (таблица Customers) и для сотрудников банка (таблица Employees):
      </p>


      <p>
        Здесь мы можем заметить, что обе таблицы, несмотря на наличие различных данных, могут характеризоваться двумя общими атрибутами - именем (FirstName) и фамилией (LastName). Выберем сразу всех клиентов банка и его сотрудников из обеих таблиц:
      </p>


      <p>В данном случае из первой таблицы выбираются два значения - имя и фамилия клиента. Из второй таблицы Employees также выбираются два значения - имя и фамилия сотрудников. То есть при объединении количество выбираемых столбцов и их тип совпадают для обеих выборок.</p>

      <img src="assets/images/postgres6.1_5.png" alt="Все клиенты банка и его сотрудники из обеих таблиц">

      <p>Если оба объединяемых набора содержат в строках идентичные значения, то при объединении повторяющиеся строки удаляются. В случае с таблицами Customers и Employees сотрудники банка могут быть одновременно его клиентами и содержаться в обеих таблицах. При объединении в примерах выше всех дублирующиеся строки удалялись. Например, исходя из начальных данных, мы видим, что два человека: Tom Smith и Mark Adams располагаются в обеих таблицах. Однако при объединении дубли не считаются, поэтому один человек учитывается только один раз.</p>

      <p>Если же необходимо при объединении сохранить все, в том числе повторяющиеся строки, то для этого необходимо использовать оператор <b>ALL:</b></p>


      <img src="assets/images/postgres6.2_5.png" alt="Оператор ALL">

      <p>При этом названия столбцов объединенной выборки будут совпадать с названия столбцов первой выборки. И если мы захотим при этом еще произвести сортировку, то в выражениях <b>ORDER BY</b> необходимо ориентироваться именно на названия столбцов первой выборки:</p>


      <p>В данном случае каждая выборка имеет по одному столбцу, который представляет объединение имени и фамилии клиента или сотрудника. Для объединения строк применяется оператор <b>||</b>. Но в случае с клиентами столбец будет называться FullName, а в случае с сотрудниками - EmployeeName. Тем не менее для сортировки применяется название столбца из первой выборки и он же будет в результирующей выборке:</p>

      <img src="assets/images/postgres6.3_5.png" alt="||">

      <p>Если же в одной выборке больше столбцов, чем в другой, то они не смогут быть объединены. Например, в следующем случае объединение завершится с ошибкой:</p>


      <p>Также соответствующие столбцы должны соответствовать по типу. Так, следующий пример завершится с ошибкой из-за не соответствия по типу данных:</p>


      <p>Здесь первый столбец первой выборки имеет тип CHARACTER VARYING, то есть хранит строку. Первый столбец второй выборки - Id имеет тип INTEGER, то есть хранит число.</p>

      <p>Объединять выборки можно и из одной и той же таблицы. Например, в зависимости от суммы на счете клиента нам надо начислять ему определенные проценты:</p>

      <p>В данном случае если сумма меньше 3000, то начисляются проценты в размере 10% от суммы на счете. Если на счете больше 3000, то проценты увеличиваются до 30%.</p>

      <img src="assets/images/postgres6.4_5.png" alt="Объединение выборок">
       
    </main>
  </div>

  <div class="transition">
    <button class="next" onclick="location.href='chapter6_4.html'">← Вернуться</button>
    <button class="next" onclick="location.href='chapter6_6.html'">Дальше →</button>
  </div>

  <footer>
    © 2025 PostgreSQL Учебный Портал. Спасибо, что учитесь с нами!
  </footer>

</body>
</html>
